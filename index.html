<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/1.11.3/css/dataTables.bootstrap4.min.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.2.9/css/responsive.bootstrap4.min.css">
  <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
  <script src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js"></script>
  <!-- <script src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script> -->
  <script src="https://cdn.datatables.net/1.11.3/js/dataTables.bootstrap4.min.js"></script>
  <script src="https://cdn.datatables.net/responsive/2.2.9/js/dataTables.responsive.min.js"></script>
  <script src="https://cdn.datatables.net/responsive/2.2.9/js/responsive.bootstrap4.min.js"></script>

  <style>
    html,
    body {
      height: 100%;
      padding: 0;
      margin: 0;
      overflow-x: hidden;
      /**/
    }

    /* show entries跟search */
    div.dataTables_wrapper div.dataTables_filter input {
      width: 100px;
    }

    /* .row:first-of-type{
      flex-wrap: nowrap;
      margin: 20px;
    } */
    table {
      table-layout: fixed;
    }

    .calculatorTable {
      margin-top: 10px;
      margin-left: 10px;
    }

    input[type=range] {
      margin: 10px 0;
    }

    .inputnumber {
      width: 55px;
    }

    .inputSearch {
      font-size: 0.7em;
      width: 100%;
      height: 25px;
    }

    ._btn- {
      width: 20px;
      height: 20px;
      padding: 0;
      line-height: 0;
      margin-left: 15px;
    }

    ._btn {
      width: 20px;
      height: 20px;
      padding: 0;
      line-height: 0;
    }

    /*.row:first-child::after {
       content: "<button>123</button>"; 
    }*/

    th {
      font-size: 0.7em;
    }

    td {
      font-size: 0.7em;
      white-space: normal;
    }

    .th0 {
      width: 25px;
    }

    .th1 {
      width: 50px;
    }

    .th2 {
      height: 10px;
      width: 90px;
    }

    .thhp {
      width: 25px;
    }

    /* Style the tab */
    .tab {
      overflow: hidden;
      /* border: 1px solid #ccc; */
      background-color: rgb(160, 160, 160);
    }

    /* Style the buttons that are used to open the tab content */
    .tab button {
      background-color: inherit;
      color: rgb(255, 255, 255);
      float: left;
      border: none;
      outline: none;
      cursor: pointer;
      padding: 8px 15px;
      transition: 0.3s;
    }

    /* Change background color of buttons on hover */
    .tab button:hover {
      background-color: rgb(130, 130, 130);
    }

    /* Create an active/current tablink class */
    .tab button.active {
      background-color: rgb(70, 70, 70);
    }

    /* Style the tab content */
    .tabcontent {
      display: none;
      padding: 6px 12px;
      border: 1px solid #ccc;
      border-top: none;
    }
  </style>
</head>

<body>

  <div class="tab" style="width: 100%;font-size: 13px;">
    <button onclick="switchTab('guide')" class="guidebtn active">圖鑑</button>
    <button onclick="switchTab('moves')" class="movesbtn">招式</button>
    <button onclick="switchTab('calculator')" class="calculatorbtn">計算器</button>
    <button onclick="switchTab('myFavorite')" class="myFavoritebtn">MY</button>
  </div>
  <!-- 圖鑑 -->
  <div id="guide">
    <table id="all" class="table table-striped table-bordered dt-responsive nowrap" style="width: 100%;">
      <thead>
        <tr id="theadtr">
          <th rowspan="2" style="width: 25px;">編號</th>
          <th rowspan="2" style="width: 50px;">名稱</th>
          <th colspan="2" style="width: 110px;text-align: center;height: 10px;padding: 0;">屬性</th>
          <th colspan="7" style="padding: 0; width: 60px;">
            <select id="selectAbility" style="width: 60px;">
              <option value="4" selected>生命</option>
              <option value="5">物攻</option>
              <option value="6">物防</option>
              <option value="7">特攻</option>
              <option value="8">特防</option>
              <option value="9">速度</option>
              <option value="10">能力值</option>
            </select>
          </th>
          <th rowspan="2">能力值</th>
          <th rowspan="2" class="thhp">總和</th>
          <th rowspan="2">加入比較</th>
        </tr>
        <tr>
          <!--colspan 是複數的下面那層  -->
          <th style="padding: 0;height: 10px;width: 45px;text-align: center;">1</th>
          <th style="padding: 0;height: 10px;width: 45px;text-align: center;">2</th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tfoot>
        <tr style="height: 25px;">
          <th id="nu" style="padding: 0;">編號</th>
          <th id="na" style="padding: 0;width: 50px;">名稱</th>
          <th colspan="2" style="padding: 0;width: 45px;text-align: center;"></th>
          <!-- <th style="padding: 0;height: 10px;width: 45px;text-align: center;">2</th> -->
          <th colspan="7"></th>
          <th class="thhp"></th>
          <th class="thhp"></th>
          <th></th>
        </tr>
      </tfoot>
    </table>
  </div>
  <!-- 招式 -->
  <div id="moves" class="tabcontent">
    <table id="movesTable" class="table table-striped table-bordered dt-responsive" style="width: 100%;">
      <thead>
        <th>編號</th>
        <th>名稱</th>
        <th></th>
      </thead>
      <tfoot>
        <th></th>
        <th id="movesThName">名稱</th>
        <th id="movesThDescription"></th>
      </tfoot>
    </table>
  </div>
  <div id="calculator" class="tabcontent">
    <div style="font-size: 0.7em;">
      <h6 style="margin: 0px 10px;">公式：</h6>
      <p style="margin: 0px 10px;">HP：(種*2+個體+努力/4)*Lv/100+Lv+10</p>
      <p style="margin: 0px 10px;">其他：[(種*2+個體+努力/4)*(Lv/100)+5]*性格</p>
      <p style="margin: 0px 10px;">傷害計算：[(2*Lv+10)/250*atk/def*威力+2]*加成</p>
    </div>
    <!-- 計算器table -->
    <table class="calculatorTable">
      <tr>
        <th>種族值</th>
        <th><input type="range" id="racerangeInput" min="0" max="200" value="100">
          <input type="button" class="_btn-" value="-" id="race-">
          <input type="number" class="inputnumber" value="100" id="race">
          <input type="button" class="_btn" value="+" id="raceplus"></button>
        </th>
      </tr>
      <tr>
        <th>個體值</th>
        <th><input type="range" id="personalrangeInput" min="0" max="31" value="31">
          <input type="button" class="_btn-" value="-" id="personal-">
          <input type="number" class="inputnumber" value="31" id="personal">
          <input type="button" class="_btn" value="+" id="personalplus"></button>
        </th>
      </tr>
      <tr>
        <th>努力值</th>
        <th><input type="range" id="effortrangeInput" min="0" max="255" value="255">
          <input type="button" class="_btn-" value="-" id="effort-">
          <input type="number" class="inputnumber" value="255" id="effort">
          <input type="button" class="_btn" value="+" id="effortplus"></button>
        </th>
      </tr>
      <tr>
        <th>Level</th>
        <th><input type="range" id="levelrangeInput" min="0" max="100" value="50">
          <input type="button" class="_btn-" value="-" id="level-">
          <input type="number" class="inputnumber" value="50" id="level">
          <input type="button" class="_btn" value="+" id="levelplus"></button>
        </th>
      </tr>
      <tr>
        <th>HP結果</th>
        <th><input type="text" class="inputnumber" value="207.375" id="Result"></th>
      </tr>
      <tr>
        <th>性格</th>
        <th><select name="" id="character">
            <option value="1.1">1.1</option>
            <option value="1" selected>1</option>
            <option value="0.9">0.9</option>
          </select></th>
      </tr>
      <tr>
        <th>能力提升</th>
        <th><select name="" id="upplus">
            <option value="0.5" selected>0.5</option>
            <option value="0.66" selected>0.66</option>
            <option value="1" selected>1</option>
            <option value="1.3">古代活性</option>
            <option value="1.5">1.5</option>
            <option value="2">2</option>
            <option value="2.5">2.5</option>
            <option value="3">3</option>
            <option value="3.5">3.5</option>
            <option value="4">4</option>
          </select>
        </th>
      </tr>
      <tr>
        <th>其他結果</th>
        <th><input type="text" class="inputnumber" value="167.6125" id="otherResult"></th>
      </tr>
      <tr>
        <th>atk</th>
        <th><input type="range" id="atkrangeInput" min="0" max="1000" value="100">
          <input type="button" class="_btn-" value="-" id="atk-">
          <input type="number" class="inputnumber" value="100" id="atk">
          <input type="button" class="_btn" value="+" id="atkplus"></button>
        </th>
      </tr>
      <tr>
        <th>def</th>
        <th><input type="range" id="defrangeInput" min="0" max="1000" value="100">
          <input type="button" class="_btn-" value="-" id="def-">
          <input type="number" class="inputnumber" value="100" id="def">
          <input type="button" class="_btn" value="+" id="defplus"></button>
        </th>
      </tr>
      <tr>
        <th>威力</th>
        <th><input type="range" id="powerrangeInput" min="0" max="200" value="80">
          <input type="button" class="_btn-" value="-" id="power-">
          <input type="number" class="inputnumber" value="80" id="power">
          <input type="button" class="_btn" value="+" id="powerplus"></button>
        </th>
      </tr>
      <tr>
        <th>本系加成</th>
        <th><select name="" id="selfplus">
            <option value="1" selected>1</option>
            <option value="1.5">1.5</option>
            <option value="2">2</option>
          </select>
        </th>
      </tr>
      <tr>
        <th>屬性相剋</th>
        <th><select name="" id="attrplus">
            <option value="0.25">0.25</option>
            <option value="0.5">0.5</option>
            <option value="1" selected>1</option>
            <option value="2">2</option>
            <option value="4">4</option>
          </select></th>
      </tr>
      <tr>
        <th>天氣加成</th>
        <th><select name="" id="weatherplus">
            <option value="0.5">0.5</option>
            <option value="1" selected>1</option>
            <option value="1.5">1.5</option>
          </select></th>
      </tr>
      <tr>
        <th>道具</th>
        <th>
          <select name="" id="staffplus">
            <option value="1.5">講究系列</option>
            <option value="1" selected>無</option>
            <option value="1.3">生命寶珠</option>
            <option value="1.1">1.1</option>
            <option value="1.2">1.2</option>
          </select>
        </th>
      </tr>
      <tr>
        <th>特性</th>
        <th><select name="" id="characterplus">
            <option value="1" selected>無</option>
            <option value="1.3">強行</option>
          </select></th>
      </tr>
      <tr>
        <th>傷害計算</th>
        <th><input type="number" class="inputnumber" value="37.2" id="damage"></th>
      </tr>
    </table>
  </div>
  <div id="myFavorite" class="tabcontent">
    <table id="myFavoriteTable" class="table table-striped table-bordered dt-responsive" style="width: 100%;">
      <thead>
        <tr id="theadtr">
          <th rowspan="2" style="width: 25px;">編號</th>
          <th rowspan="2" style="width: 50px;">名稱</th>
          <th colspan="2" style="width: 110px;text-align: center;height: 10px;padding: 0;">屬性</th>
          <th colspan="7" style="padding: 0; width: 60px;">
            <select id="selectAbility2" style="width: 60px;">
              <option value="4" selected>生命</option>
              <option value="5">物攻</option>
              <option value="6">物防</option>
              <option value="7">特攻</option>
              <option value="8">特防</option>
              <option value="9">速度</option>
              <option value="10">能力值</option>
            </select>
          </th>
          <th rowspan="2">能力值</th>
          <th rowspan="2" class="thhp">總和</th>
          <th rowspan="2" class="thhp"></th>
        </tr>
        <tr>
          <!--colspan 是複數的下面那層  -->
          <th style="padding: 0;height: 10px;width: 45px;text-align: center;">1</th>
          <th style="padding: 0;height: 10px;width: 45px;text-align: center;">2</th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tfoot>
        <tr style="height: 25px;">
          <th id="nu" style="padding: 0;">編號</th>
          <th id="na" style="padding: 0;width: 50px;">名稱</th>
          <th colspan="2" style="padding: 0;width: 45px;text-align: center;"></th>
          <!-- <th style="padding: 0;height: 10px;width: 45px;text-align: center;">2</th> -->
          <th colspan="7"></th>
          <th class="thhp"></th>
          <th class="thhp"></th>
          <th></th>
        </tr>
      </tfoot>
    </table>
  </div>
</body>
<script>
  var selectAbilityPreSelect = "4";
  //+- start
  $('#raceplus,#personalplus,#effortplus,#levelplus,#atkplus,#defplus,#powerplus').click(function () {
    var id = "#" + $(this).attr("id").replace('plus', '');
    var value = parseInt($(id).val()) + 1;
    $(id).val(value);
    $(id + "rangeInput").val(value);
    calculate();
  });
  $('#race-,#personal-,#effort-,#level-,#atk-,#def-,#power-').click(function () {
    var id = "#" + $(this).attr("id").replace('-', '');
    var value = parseInt($(id).val()) - 1;
    $(id).val(value);
    $(id + "rangeInput").val(value);
    calculate();
  });
  //+- end
  //拖拉同步改變text值
  $('#racerangeInput,#personalrangeInput,#effortrangeInput,#levelrangeInput,#atkrangeInput,#defrangeInput,#powerrangeInput').on('input', function () {
    var id = "#" + $(this).attr("id").replace('rangeInput', '');
    $(id).val($(this).val());
  });
  //text值同步改變拖拉長度
  $('#race,#personal,#effort,#level,#atk,#def,#power').on('input', function () {
    var rangeInputName = "#" + $(this).attr("id") + "rangeInput";
    $(rangeInputName).val($(this).val());
  });
  var calculate = function () {
    var race = parseInt($('#race').val());
    var personal = parseInt($('#personal').val());
    var effort = parseInt($('#effort').val());
    var level = parseInt($('#level').val());
    var charact = parseFloat($('#character').val());
    var res = (race * 2 + personal + effort / 4) * (level / 100) + level + 10;
    var upplus = parseFloat($('#upplus').val());
    var otherres = ((race * 2 + personal + effort / 4) * (level / 100) + 5) * charact * upplus;
    $('#Result').val(res.toString());
    $('#otherResult').val(otherres.toString());
    var atk = parseInt($('#atk').val());
    var def = parseInt($('#def').val());
    var power = parseInt($('#power').val());
    var selfplus = parseFloat($('#selfplus').val());
    var attrplus = parseFloat($('#attrplus').val());
    var weatherplus = parseFloat($('#weatherplus').val());
    var staffplus = parseFloat($('#staffplus').val());
    var characterplus = parseFloat($('#characterplus').val());
    var calculatedamage = ((2 * level + 10) / 250 * atk / def * power + 2) * selfplus * attrplus * weatherplus * staffplus * characterplus;
    $('#damage').val(calculatedamage.toString());
  }
  //改變值立刻計算結果
  $('#race,#personal,#effort,#level,#racerangeInput,#personalrangeInput,#effortrangeInput,#levelrangeInput,#atkrangeInput,#defrangeInput,#powerrangeInput,#atk,#def,#power').on('input', calculate);
  $('#character,#upplus,#selfplus,#attrplus,#weatherplus,#staffplus,#characterplus').on('change', calculate);
  //tab switch
  function switchTab(id) {
    var allTable = ["guide", "moves", "calculator", "myFavorite"];
    for (var i in allTable) {
      if (allTable[i] != id) {
        document.getElementById(allTable[i]).style.display = 'none';
        document.getElementsByClassName(allTable[i] + "btn")[0].className = document.getElementsByClassName(allTable[i] + "btn")[0].className.replace(" active", "");
      }
      else {
        if (document.getElementsByClassName(allTable[i] + "btn")[0].className.includes(" active"))
          return;
        document.getElementById(allTable[i]).style.display = 'table-row';
        document.getElementsByClassName(allTable[i] + "btn")[0].className += " active";
      }

    }
  }
  //table 1的資料表
  var column = ["編號", "名稱", "屬性", "生命", "物攻", "物防", "特攻", "特防", "速度"];
  var GetFiveTotal = function (data) {
    var inthp = parseInt(data["hp"]);
    var intatk = parseInt(data["atk"]);
    var intdef = parseInt(data["def"]);
    var intsatk = parseInt(data["satk"]);
    var intsdef = parseInt(data["sdef"]);
    var intspeed = parseInt(data["speed"]);
    return inthp + intatk + intdef + intsatk + intsdef + intspeed;
  }
  var GetFiveChart = function (data) {
    var x = 150, y = 15;
    var hp = parseInt(data["hp"]);
    var atk = parseInt(data["atk"]);
    var def = parseInt(data["def"]);
    var satk = parseInt(data["satk"]);
    var sdef = parseInt(data["sdef"]);
    var speed = parseInt(data["speed"]);
    column2 = ["", "", "", hp, atk, def, satk, sdef, speed];// / 255 * x
    var r = "";
    for (var i = 3; i < column.length; i++) {
      r += `<div>
      <div style="display: inline-block;">${column[i]}</div>
      <div style="position:relative;display: inline-block;">
        <div style="width:${x}px;height:${y}px;background-color: green;"></div>
      <div style="width:${column2[i] / 255 * x}px;height:${y}px;background-color:chartreuse;border:1px black solid;position:absolute;top:0px;"></div>
      </div> ${column2[i]}</div>`;
    }
    return r;
  }
  var AddToTable = function (data) {
    // console.log(data["hp"]);
    // return `<button onclick="ClickAddToTable('${data["number"].replace('\n','')}')">加入</button>`;
    // return `<button onclick="ClickAddToTable('${data["number"].replace('\n','')}')">加入</button>`;
    return `<input type="button" value="加入" class="ClickAddToTable">`;
  }
  var RemoveFromTable = function (data) {
    return `<input type="button" value="移除" class="ClickRemoveFromTable">`;
  }
  //全域變數存目前點的tr
  var currentClickTr;
  // var t = $('#myFavoriteTable').DataTable();
  var table3;

  var columns = [
    { "data": "number", "width": "14%" },
    { "data": "cName", "width": "26%" },
    { "data": "attr1", "width": "20%" },
    { "data": "attr2", "width": "20%" },
    { "data": "hp", "width": "20%" },
    { "data": "atk", "width": "20%" },
    { "data": "def", "width": "20%" },
    { "data": "satk", "width": "20%" },
    { "data": "sdef", "width": "20%" },
    { "data": "speed", "width": "20%" },
    { "data": null, render: GetFiveTotal },
    { "data": null, render: GetFiveChart, className: 'none' },//className:'none'一定縮
    { "data": null, render: GetFiveTotal, className: 'none' },
    { 'data': null, render: AddToTable, className: 'none' },
  ];
  //tfoot的搜尋功能
  $('#nu,#na').each(function () {
    var title = $(this).text();
    $(this).html('<input type="text" class="inputSearch" placeholder="' + title + '" />');
  });
  $('#movesThName,#movesThDescription').each(function () {
    var title = $(this).text();
    $(this).html('<input type="text" class="inputSearch" placeholder="' + title + '" />');
  });
  $(document).ready(function () {
    var table = $('#all').DataTable({
      "language": {
        "lengthMenu": "_MENU_",
      },
      "dom": `<'row'<'col-4 col-sm-4 col-md-4'l><'col-8 col-sm-8 col-md-8'f>>
            <'row'<'col-sm-12'tr>>
            <'row'<'col-sm-12 col-md-5'i><'col-sm-12 col-md-7'p>>`,
      "autoWidth": false,
      "ajax": "data.json",
      //拿到ajax的結果
      // "drawCallback": function (settings) {
      //   // Here the response
      //   response = settings.json;

      // },
      "columns": columns,
      // "info":     false,
      "pagingType": "numbers",
      initComplete: function () {
        // Apply the search
        //指定欄位搜尋
        this.api()
          .columns([0, 1])//用column指定
          .every(function () {
            var that = this
            $('input', this.footer()).on('keyup change clear', function () {
              if (that.search() !== this.value) {
                that.search(this.value).draw();
              }
            });
          });
        //指定欄位下拉選單
        var column23 = this.api();
        this.api()
          .columns(2)
          .every(function () {
            var column = this;
            var select = $('<select style=" height: 25px; " ><option value=""></option></select>')
              .appendTo($(column.footer()).empty())
              .on('change', function () {
                var val = $.fn.dataTable.util.escapeRegex($(this).val());//這裡的this是option的值
                column23.search(val).draw();
                // filterColumn23(val);
                // (column.search(val,false, true)+column3.search(val,false, true)).draw();
                // console.log(typeof(column.search(val,false, true)));
                // column3.search("^" + val,true,false,true).draw();
                // column3.search(val).draw();
              });

            column
              .data()
              .unique()
              .sort()
              .each(function (d, j) {
                if (typeof (d) == 'string')
                  select.append('<option value="' + d + '">' + d + '</option>');
              });
          });
      },
      "columnDefs": [
        { "width": "10%", targets: 0, responsivePriority: 1 },
        { "width": "20%", targets: 1, responsivePriority: 2 },
        { "width": "20%", targets: 2, responsivePriority: 3 },
        { "width": "20%", targets: 3, responsivePriority: 3 },
        { "width": "20%", targets: 4, responsivePriority: 3 },
      ],
    });
    var table2 = $('#movesTable').DataTable({
      "language": {
        "lengthMenu": "_MENU_",
      },
      "dom": `<'row'<'col-4 col-sm-6 col-md-6'l><'col-8 col-sm-6 col-md-6'f>>
            <'row'<'col-sm-12'tr>>
            <'row'<'col-sm-12 col-md-5'i><'col-sm-12 col-md-7'p>>`,
      "ajax": "特性.json",
      "pagingType": "numbers",
      "autoWidth": false,
      "columns": [{'data':'編號',"width": "10%" },{ 'data': '中文名',"width": "90%"  }, { 'data': '效果', className: 'none' }],
      initComplete: function () {
        // Apply the search
        //指定欄位搜尋
        this.api()
          .columns([0, 1])//用column指定
          .every(function () {
            var that = this
            $('input', this.footer()).on('keyup change clear', function () {
              if (that.search() !== this.value) {
                that.search(this.value).draw();
              }
            });
          });
      },
    });
    table3 = $('#myFavoriteTable').DataTable({
      "language": {
        "lengthMenu": "_MENU_",
      },
      "dom": `<'row'<'col-4 col-sm-4 col-md-4'l><'col-8 col-sm-8 col-md-8'f>>
            <'row'<'col-sm-12'tr>>
            <'row'<'col-sm-12 col-md-5'i><'col-sm-12 col-md-7'p>>`,
      "autoWidth": false,
      "columns": [
        { "data": "number", "width": "14%" },
        { "data": "cName", "width": "26%" },
        { "data": "attr1", "width": "20%" },
        { "data": "attr2", "width": "20%" },
        { "data": "hp", "width": "20%" },
        { "data": "atk", "width": "20%" },
        { "data": "def", "width": "20%" },
        { "data": "satk", "width": "20%" },
        { "data": "sdef", "width": "20%" },
        { "data": "speed", "width": "20%" },
        { "data": null, render: GetFiveTotal },
        { "data": null, render: GetFiveChart, className: 'none' },//className:'none'一定縮
        { "data": null, render: GetFiveTotal, className: 'none' },
        { 'data': null, render: RemoveFromTable, className: 'none' },
      ],
      "pagingType": "numbers",
      initComplete: function () {
        // Apply the search
        //指定欄位搜尋
        this.api()
          .columns([0, 1])//用column指定
          .every(function () {
            var that = this
            $('input', this.footer()).on('keyup change clear', function () {
              if (that.search() !== this.value) {
                that.search(this.value).draw();
              }
            });
          });
        //指定欄位下拉選單
        var column23 = this.api();
        this.api()
          .columns(2)
          .every(function () {
            var column = this;
            var select = $('<select style=" height: 25px; " ><option value=""></option></select>')
              .appendTo($(column.footer()).empty())
              .on('change', function () {
                var val = $.fn.dataTable.util.escapeRegex($(this).val());//這裡的this是option的值
                column23.search(val).draw();
              });

            column
              .data()
              .unique()
              .sort()
              .each(function (d, j) {
                if (typeof (d) == 'string')
                  select.append('<option value="' + d + '">' + d + '</option>');
              });
          });
      },
    });

    //先隱藏，透過select option切換
    table.column(5).visible(false);
    table.column(6).visible(false);
    table.column(7).visible(false);
    table.column(8).visible(false);
    table.column(9).visible(false);
    table.column(10).visible(false);
    table3.column(5).visible(false);
    table3.column(6).visible(false);
    table3.column(7).visible(false);
    table3.column(8).visible(false);
    table3.column(9).visible(false);
    table3.column(10).visible(false);
    $('#selectAbility').click(function (e) {
      //點選的時候預防點到下層
      e.stopPropagation();
    });
    $('#selectAbility').change(function (e) {
      var column = table.column(selectAbilityPreSelect);
      column.visible(!column.visible());
      var column2 = table.column($(this).val());
      column2.visible(!column2.visible());
      selectAbilityPreSelect = $(this).val();
    });
    $('#selectAbility2').change(function (e) {
      var column = table3.column(selectAbilityPreSelect);
      column.visible(!column.visible());
      var column2 = table3.column($(this).val());
      column2.visible(!column2.visible());
      selectAbilityPreSelect = $(this).val();
    });
    $('#all tbody').on('click', '.ClickAddToTable', function () {
      table3.row.add(table.row(this).data()).draw(false);
    });
    $('#myFavorite tbody').on('click', '.ClickRemoveFromTable', function () {
      table3.row(table.row(this).data()).remove().draw(false);
    });
  });
</script>

</html>