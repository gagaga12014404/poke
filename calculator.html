<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<style>
  .Nature button {
    background-color: inherit;
    color: rgb(182, 182, 182);
    /* float: left; */
    border: none;
    outline: none;
    cursor: pointer;
    /* padding: 8px 15px; */
    transition: 0.3s;
  }

  .Nature button.active {
    background-color: rgb(70, 70, 70);
  }

  ._btn- {
    width: 25px;
    height: 25px;
    padding: 0;
    line-height: 0;
  }

  ._btn {
    width: 25px;
    height: 25px;
    padding: 0;
    line-height: 0;
  }

  .inputnumber {
    width: 30px;
  }

  #damage {
    width: 60px;
  }

  th {
    font-size: 12px;
  }

  td {
    font-size: 12px;
  }

  .SpeciesStrength {
    text-align: left;
    width: 40px;
  }

  #levelrangeInput {
    width: 70px;
  }

  #atkerTable input[type=text] {
    width: 30px;
    border: 0;
    margin-left: 0;
    background: transparent;
  }

  #deferTable input[type=text] {
    width: 30px;
    border: 0;
    margin-left: 0;
    background: transparent;
  }

  /* input[type=text] {
    width: 30px;
    border: 0;
    margin-left: 0;
    background: transparent;
  } */

  table {
    width: 100%;
    max-width: 500px;
  }

  .hidden公式 {
    display: none;
  }
</style>

<body>
  <!-- 計算器table -->
  <table>
    <tr>
      <td id="atker" style="padding: 0px;">
        <h6 style="text-align: center;">攻擊方</h6>
        <select name="" id="atkerName" style="width:100px"></select>
      </td>

      <td id="defer" style="padding: 0px;">
        <h6 style="text-align: center;">防守方</h6>
        <select name="" id="deferName" style="width:100px"></select>
      </td>
    </tr>
  </table>
  <table style="display: block;margin:10px">
    <tr>
      <th>Level</th>
      <th>
        <input type="range" id="levelrangeInput" min="0" max="100" value="50">
        <input type="button" class="_btn-" value="-" id="level-">
        <input type="number" class="inputnumber" value="50" id="level" style="width: 50px;">
        <input type="button" class="_btn" value="+" id="levelplus">
      </th>
    </tr>
    <tr>
      <th>能力提升</th>
      <th><select name="" id="upplus">
          <option value="0.5" selected>0.5</option>
          <option value="0.66" selected>0.66</option>
          <option value="1" selected>1</option>
          <option value="1.3">1.3</option>
          <option value="1.5">1.5</option>
          <option value="2">2</option>
          <option value="2.5">2.5</option>
          <option value="3">3</option>
          <option value="3.5">3.5</option>
          <option value="4">4</option>
        </select>
      </th>
    </tr>
    <!-- <tr>
      <th>其他結果</th>
      <th><input type="text" class="inputnumber" value="167.6125" id="otherResult"></th>
    </tr> -->
    <tr>
      <th>atk</th>
      <th><input type="range" id="atkrangeInput" min="0" max="332" value="100">
        <input type="button" class="_btn-" value="-" id="atk-">
        <input type="number" style="width: 50px;padding: 0 0 5px 5px;" class="inputnumber" value="100" id="atk">
        <input type="button" class="_btn" value="+" id="atkplus"></button>
      </th>
    </tr>
    <tr>
      <th>def</th>
      <th><input type="range" id="defrangeInput" min="0" max="332" value="100">
        <input type="button" class="_btn-" value="-" id="def-">
        <input type="number" style="width: 50px;" class="inputnumber" value="100" id="def">
        <input type="button" class="_btn" value="+" id="defplus"></button>
      </th>
    </tr>
    <tr>
      <th>威力</th>
      <th><input type="range" id="powerrangeInput" min="0" max="200" value="80">
        <input type="button" class="_btn-" value="-" id="power-">
        <input type="number" style="width: 50px;" class="inputnumber" value="80" id="power">
        <input type="button" class="_btn" value="+" id="powerplus"></button>
      </th>
    </tr>
    <tr>
      <th>本系加成</th>
      <th><select name="" id="selfplus">
          <option value="1" selected>1</option>
          <option value="1.5">1.5</option>
          <option value="2">2</option>
        </select>
      </th>
    </tr>
    <tr>
      <th>屬性相剋</th>
      <th><select name="" id="attrplus">
          <option value="0.25">0.25</option>
          <option value="0.5">0.5</option>
          <option value="1" selected>1</option>
          <option value="2">2</option>
          <option value="4">4</option>
        </select></th>
    </tr>
    <tr>
      <th>天氣加成</th>
      <th><select name="" id="weatherplus">
          <option value="0.5">0.5</option>
          <option value="1" selected>1</option>
          <option value="1.5">1.5</option>
        </select></th>
    </tr>
    <tr>
      <th>道具</th>
      <th>
        <select name="" id="staffplus">
          <option value="1.5">講究系列</option>
          <option value="1" selected>無</option>
          <option value="1.3">生命寶珠</option>
          <option value="1.1">1.1</option>
          <option value="1.2">1.2</option>
        </select>
      </th>
    </tr>
    <tr>
      <th>特性</th>
      <th>
        <select name="" id="characterplus">
          <option value="1" selected>無</option>
          <option value="1.3">強行</option>
        </select>
      </th>
    </tr>
    <tr>
      <th>傷害計算</th>
      <th><input type="text" class="inputnumber" value="37.2" id="damage"></th>
    </tr>
  </table>

  <div style="font-size: 0.7em;text-align:right">
    <h6 onclick="open公式()" style="margin: 0px 10px;">公式</h6>
    <p class="hidden公式" style="margin: 0px 10px;">HP：(種*2+個體+努力/4)*Lv/100+Lv+10</p>
    <p class="hidden公式" style="margin: 0px 10px;">其他：[(種*2+個體+努力/4)*(Lv/100)+5]*性格</p>
    <p class="hidden公式" style="margin: 0px 10px;">傷害計算：[(2*Lv+10)/250*atk/def*威力+2]*加成</p>
  </div>
</body>
<script>
  var formulasVisible = false;

  function open公式() {
    var formulas = document.querySelectorAll('.hidden公式');
    for (var i = 0; i < formulas.length; i++) {
      if (formulasVisible) {
        formulas[i].style.display = 'none'; // 隐藏<p>元素
      } else {
        formulas[i].style.display = 'block'; // 显示<p>元素
      }
    }
    formulasVisible = !formulasVisible; // 切换状态
  }

  var input6 = ["HP", "ATK", "SATK", "DEF", "SDEF", "SPEED"];
  var raceArray = {};
  ["atker", "defer"].forEach(i => {
    var tableString = `
          <table id="${i}Table" style="display:block">
            <tr>
              <td></td>
              <td style="text-align: center;">HP<br><input style="text-align: center;" type="text" readonly value="100" id="${i}HPstrength"></td>
              <td></td>
            </tr>
            <tr>
              <td style="text-align: right;">SATK<br><input style="text-align: right;" type="text" readonly value="100" id="${i}SATKstrength"></td>
              <td rowspan="2" id="${i}drawhexagon">
                <div>
                  <canvas id="${i}canvas" width="100" height="100"></canvas>
                </div>
              </td>
              <td style="text-align: left;">ATK<br><input style="text-align: left;" type="text" readonly value="100" id="${i}ATKstrength"></td>
            </tr>
            <tr>
              <td style="text-align: right;">SDEF<br><input style="text-align: right;" type="text" readonly value="100" id="${i}SDEFstrength"></td>
              <td style="text-align: left;">DEF<br><input style="text-align: left;" type="text" readonly value="100" id="${i}DEFstrength"></td>
            </tr>
            <tr>
              <td></td>
              <td style="text-align: center;">SPEED<br><input style="text-align: center;" type="text" readonly value="100" id="${i}SPEEDstrength"></td>
              <td></td>
            </tr>
          </table>`;
    $('#' + i).append(tableString);
    var input6string = "";
    input6.forEach(j => {
      input6string +=
        `<tr>
          <td><input type="button" style="padding:0;width:100%" id="${i}${j}button" value="${j}"></td>
          <td style="text-align:center">
            <input type="text" style="width:20px" id="${i}${j}select" value="31">
          </td>
          <td style="text-align:center">
            <input type="range" id="${i}${j}rangeInput" min="0" max="252" value="0" style="width: 80px;">
            <br>
            <input type="button" class="_btn-" value="-" id="${i}${j}-">
            <input type="text" style="width:30px" readonly class="inputnumber" value="0" id="${i}${j}Effort">
            <input type="button" class="_btn" value="+" id="${i}${j}plus">
          </td>
        </tr>`
    });
    var inputTotalString =
      `<table style="border: 1px solid black;width:100%">
        <!-- 填入 -->
        <tr>
          <th style="width:20%"></th>
          <th style="width:20%">個體值</th>
          <th style="width:50%;text-align:center">努力值</th>
        </tr>
        ${input6string}
        <tr>
          <td style="padding:25px 0 0 0">性格</td>
          <td class="${i}Nature" style="padding:25px 0 0 0">
            <select name="" id="${i}selectNature">
              <option value="Adamant">固執+A-SA</option>
              <option value="Modest">內斂+SA-A</option>
              <option value="Timid">膽小+SP-A</option>
              <option value="Jolly">爽朗+SP-SA</option>
              <option value="Lonely">怕寂寞+A-D</option>
              <option value="Naughty">頑皮+A-SD</option>
              <option value="Brave">勇敢+A-SP</option>
              <option value="Bold">大膽+D-A</option>
              <option value="Impish">陶氣+D-SA</option>
              <option value="Lax">樂天+D-SD</option>
              <option value="Relaxed">悠閒+D-SP</option>
              <option value="Mild">慢吞吞+SA-D</option>
              <option value="Rash">馬虎+SA-SD</option>
              <option value="Quiet">冷靜+SA-SP</option>
              <option value="Calm">溫和+SD-A</option>
              <option value="Gentle">溫順+SD-D</option>
              <option value="Careful">慎重+SD-SA</option>
              <option value="Sassy">自大+SD-SP</option>
              <option value="Hasty">急躁+SP-D</option>
              <option value="Naive">天真+SP-SD</option>
            </select>
          </td>
        </tr>
        <tr>
          <td>總和</td>
          <td><input type="text" readonly value="0" id="${i}totaleffort" style="width:40px"></td>
        </tr>
      </table>`;
    $('#' + i).append(inputTotalString);
  });
  //6角形
  function draw6angle(canvasId, sideLength, angle1, angle2, angle3, angle4, angle5, angle6, color, add1, add2, add3, add4, add5, add6) {
    var canvas = document.getElementById(canvasId);
    var ctx = canvas.getContext("2d");
    // 計算正六邊形的中心點座標
    var centerX = canvas.width / 2;
    var centerY = canvas.height / 2;

    // sideLength正六邊形的邊長

    // 定義六個頂點的座標
    var x1 = centerX + add1 + sideLength * Math.cos(angle1 * Math.PI / 180);
    var y1 = centerY - add1 / 1.8 - sideLength * Math.sin(angle1 * Math.PI / 180);//atk

    var x2 = centerX + sideLength * Math.cos(angle2 * Math.PI / 180);//hp
    var y2 = centerY - add2 - sideLength * Math.sin(angle2 * Math.PI / 180);

    var x3 = centerX - add3 + sideLength * Math.cos(angle3 * Math.PI / 180);//satk
    var y3 = centerY - add3 / 1.8 - sideLength * Math.sin(angle3 * Math.PI / 180);

    var x4 = centerX - add4 + sideLength * Math.cos(angle4 * Math.PI / 180);//def
    var y4 = centerY + add4 / 1.8 - sideLength * Math.sin(angle4 * Math.PI / 180);

    var x5 = centerX + sideLength * Math.cos(angle5 * Math.PI / 180);//speed
    var y5 = centerY + add5 - sideLength * Math.sin(angle5 * Math.PI / 180);

    var x6 = centerX + add6 + sideLength * Math.cos(angle6 * Math.PI / 180);//sdef
    var y6 = centerY + add6 / 1.8 - sideLength * Math.sin(angle6 * Math.PI / 180);
    // 開始繪製
    ctx.beginPath();
    ctx.moveTo(x1, y1); // 移動到第一個頂點
    ctx.lineTo(x2, y2);
    ctx.lineTo(x3, y3);
    ctx.lineTo(x4, y4);
    ctx.lineTo(x5, y5);
    ctx.lineTo(x6, y6);
    ctx.closePath(); // 連線回第一個頂點，形成封閉的正六邊形
    ctx.fillStyle = color; // 填充顏色為藍色
    ctx.fill(); // 填充正六邊形

    // 結束繪製
    ctx.closePath();
  }
  ["atker", "defer"].forEach(i => {
    var canvasId = i + "canvas";
    draw6angle(canvasId, 60, 30, 90, 150, 210, 270, 330, "gray", 0, 0, 0, 0, 0, 0);
    draw6angle(canvasId, 4.8, 30, 90, 150, 210, 270, 330, "yellow", 0, 0, 0, 0, 0, 0);//從stak開始
  });
  function change6angle(i, hpeffort, atkeffort, satkeffort, defeffort, sdefeffort, speedeffort) {
    //console.log(hpeffort, atkeffort, satkeffort, defeffort, sdefeffort, speedeffort)
    var canvasId = i + "canvas";
    var canvas = document.getElementById(canvasId); // 替換為您的畫布ID
    var ctx = canvas.getContext("2d");
    // 清空整個畫布
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    draw6angle(canvasId, 50, 30, 90, 150, 210, 270, 330, "gray", 0, 0, 0, 0, 0, 0);
    draw6angle(canvasId, 4, 30, 90, 150, 210, 270, 330, "yellow", atkeffort, hpeffort, satkeffort, sdefeffort, speedeffort, defeffort);//從stak開始

  }
  //6角形結束
  ["atker", "defer"].forEach(i => {
    input6.forEach(j => {
      let selectId = '#' + i + j + 'select';
      $(selectId).on('change', function () {
        if (isNaN($(this).val()))
          $(this).val(31);
        else if (parseInt($(this).val()) > 31)
          $(this).val(31);
        if (parseInt($(this).val()) < 0)
          $(this).val(0);
        calculateEach(i);
      });
    });
  });
  var _6species = ["HP", "ATK", "DEF", "SATK", "SDEF", "SPEED"];
  _6species.forEach(element => {
    // var str = `
    // <tbody>
    // </tbody>`;
    // $('#atkerTable').append(str);
  });
  $(document).ready(function () {
    $('#atkerName').select2();
    $('#deferName').select2();
    raceArray["atkerHPrace"] = 45;
    raceArray["atkerATKrace"] = 49;
    raceArray["atkerSATKrace"] = 65;
    raceArray["atkerDEFrace"] = 49;
    raceArray["atkerSDEFrace"] = 65;
    raceArray["atkerSPEEDrace"] = 45;

    raceArray["deferHPrace"] = 45;
    raceArray["deferATKrace"] = 49;
    raceArray["deferSATKrace"] = 65;
    raceArray["deferDEFrace"] = 49;
    raceArray["deferSDEFrace"] = 65;
    raceArray["deferSPEEDrace"] = 45;
    calculateEach("atker");
    calculateEach("defer");
    ["atker", "defer"].forEach(i => {
      $('#' + i + 'Name').on('change', function () {
        var cname = this.value;
        raceArray[i + 'HPrace'] = ajaxdata[cname]['hp'];
        raceArray[i + 'ATKrace'] = ajaxdata[cname]['atk'];
        raceArray[i + 'DEFrace'] = ajaxdata[cname]['def'];
        raceArray[i + 'SATKrace'] = ajaxdata[cname]['satk'];
        raceArray[i + 'SDEFrace'] = ajaxdata[cname]['sdef'];
        raceArray[i + 'SPEEDrace'] = ajaxdata[cname]['speed'];
        calculateEach(i);
      });
    });
  });
  function switchcalculatorTab(id) {
    var allTable = ["atker", "defer"];
    for (var i in allTable) {
      if (allTable[i] != id) {
        document.getElementById(allTable[i]).style.display = 'none';
        document.getElementsByClassName(allTable[i] + "btn")[0].className = document.getElementsByClassName(allTable[i] + "btn")[0].className.replace(" active", "");
      }
      else {
        if (document.getElementsByClassName(allTable[i] + "btn")[0].className.includes(" active"))
          return;
        document.getElementById(allTable[i]).style.display = 'table-row';
        document.getElementsByClassName(allTable[i] + "btn")[0].className += " active";
      }
    }
  }
  //tab switch
  var natureVal = 1.1;
  function switchNature1Tab(id) {
    var allTable = ["Nature1.1", "Nature1", "Nature0.9"];
    for (var i in allTable) {
      if (allTable[i] != id) {
        document.getElementsByClassName(allTable[i] + "btn")[0].className = document.getElementsByClassName(allTable[i] + "btn")[0].className.replace(" active", "");
      }
      else {
        if (document.getElementsByClassName(allTable[i] + "btn")[0].className.includes(" active"))
          return;
        document.getElementsByClassName(allTable[i] + "btn")[0].className += " active";
        natureVal = parseFloat(id.replace("Nature", ""));
        calculate();
      }
    }
  }
  //+- start

  function IsOver508(i) {
    var hpeffort = parseInt($('#' + i + 'HPEffort').val());
    var atkeffort = parseInt($('#' + i + 'ATKEffort').val());
    var satkeffort = parseInt($('#' + i + 'SATKEffort').val());
    var defeffort = parseInt($('#' + i + 'DEFEffort').val());
    var sdefeffort = parseInt($('#' + i + 'SDEFEffort').val());
    var speedeffort = parseInt($('#' + i + 'SPEEDEffort').val());
    return hpeffort + atkeffort + satkeffort + defeffort + sdefeffort + speedeffort;
  }
  ["atker", "defer"].forEach(i => {
    input6.forEach(j => {
      ['plus', '-'].forEach(k => {
        $('#' + i + j + k).click(function () {
          if (IsOver508(i) >= 510 && k == 'plus') return;//點下去的時候，510以上就return，但是拉條不能這樣做
          var id = "#" + $(this).attr("id").replace(k, '');
          var value = 0;
          if (k == 'plus')
            value = parseInt($(id + 'Effort').val()) + 1;
          else if (k == "-" && parseInt($(id + 'Effort').val()) > 0)
            value = parseInt($(id + 'Effort').val()) - 1;
          else
            value = parseInt($(id + 'Effort').val());
          $(id + 'Effort').val(value);
          $(id + "rangeInput").val(value);
          calculateEach(i);
        });
      });
    });
  });
  ["atker", "defer"].forEach(i => {
    input6.forEach(j => {
      $('#' + i + j + 'rangeInput').on('input', function () {
        var total = 0;
        input6.forEach(k => {
          if (k !== j) total += parseInt($('#' + i + k + 'rangeInput').val());
        });
        if (total + parseInt($(this).val()) > 510) {
          $(this).val(510 - total);
        }
        var id = "#" + $(this).attr("id").replace('rangeInput', 'Effort');
        $(id).val($(this).val());
        calculateEach(i);
      });
    });
  });
  $('#raceplus,#personalplus,#effortplus,#levelplus,#atkplus,#defplus,#powerplus').click(function () {
    var id = "#" + $(this).attr("id").replace('plus', '');
    var value = parseInt($(id).val()) + 1;
    $(id).val(value);
    $(id + "rangeInput").val(value);
    calculate();
  });
  $('#race-,#personal-,#effort-,#level-,#atk-,#def-,#power-').click(function () {
    var id = "#" + $(this).attr("id").replace('-', '');
    var value = parseInt($(id).val()) - 1;
    $(id).val(value);
    $(id + "rangeInput").val(value);
    calculate();
  });
  //+- end
  //拖拉同步改變text值
  $('#racerangeInput,#personalrangeInput,#effortrangeInput,#levelrangeInput,#atkrangeInput,#defrangeInput,#powerrangeInput').on('input', function () {
    var id = "#" + $(this).attr("id").replace('rangeInput', '');
    $(id).val($(this).val());
  });
  //text值同步改變拖拉長度
  $('#race,#personal,#effort,#level,#atk,#def,#power').on('input', function () {
    var rangeInputName = "#" + $(this).attr("id") + "rangeInput";
    $(rangeInputName).val($(this).val());
  });
  var charactArray;
  function GetCharact(i, j) {
    var charact = 1;
    switch ($('#' + i + 'selectNature').val()) {
      case "Adamant":
        if (j == "ATK") charact = 1.1;
        if (j == "SATK") charact = 0.9; break;
      case "Modest":
        if (j == "SATK") charact = 1.1;
        if (j == "ATK") charact = 0.9; break;
      case "Timid":
        if (j == "SPEED") charact = 1.1;
        if (j == "ATK") charact = 0.9; break;
      case "Jolly":
        if (j == "SPEED") charact = 1.1;
        if (j == "SATK") charact = 0.9; break;
      case "Lonely":
        if (j == "ATK") charact = 1.1;
        if (j == "DEF") charact = 0.9; break;
      case "Naughty":
        if (j == "ATK") charact = 1.1;
        if (j == "SDEF") charact = 0.9; break;
      case "Brave":
        if (j == "ATK") charact = 1.1;
        if (j == "SPEED") charact = 0.9; break;
      case "Bold":
        if (j == "DEF") charact = 1.1;
        if (j == "ATK") charact = 0.9; break;
      case "Impish":
        if (j == "DEF") charact = 1.1;
        if (j == "SATK") charact = 0.9; break;
      case "Lax":
        if (j == "DEF") charact = 1.1;
        if (j == "SDEF") charact = 0.9; break;
      case "Relaxed":
        if (j == "DEF") charact = 1.1;
        if (j == "SPEED") charact = 0.9; break;
      case "Mild":
        if (j == "SATK") charact = 1.1;
        if (j == "DEF") charact = 0.9; break;
      case "Rash":
        if (j == "SATK") charact = 1.1;
        if (j == "SDEF") charact = 0.9; break;
      case "Quiet":
        if (j == "SATK") charact = 1.1;
        if (j == "SPEED") charact = 0.9; break;
      case "Calm":
        if (j == "SDEF") charact = 1.1;
        if (j == "ATK") charact = 0.9; break;
      case "Gentle":
        if (j == "SDEF") charact = 1.1;
        if (j == "DEF") charact = 0.9; break;
      case "Careful":
        if (j == "SDEF") charact = 1.1;
        if (j == "SATK") charact = 0.9; break;
      case "Sassy":
        if (j == "SDEF") charact = 1.1;
        if (j == "SPEED") charact = 0.9; break;
      case "Hasty":
        if (j == "SPEED") charact = 1.1;
        if (j == "DEF") charact = 0.9; break;
      case "Naive":
        if (j == "SPEED") charact = 1.1;
        if (j == "SDEF") charact = 0.9; break;
    }
    //console.log(i + " " + j + " " + charact);
    return charact;
  }
  var calculateEach = function (i) {//i=atker,defer
    //console.log(raceArray);
    let totaleffort = 0;
    input6.forEach(j => {//j=6 
      var race = parseInt(raceArray[i + j + 'race']);
      var personal = parseInt($('#' + i + j + 'select').val());
      var effort = parseInt($('#' + i + j + 'Effort').val());
      var level = 50;
      var charact = GetCharact(i, j);
      var upplus = 1;
      var hpResult = ((race * 2 + personal + effort / 4) * (level / 100)) + level + 10;
      var result = ((race * 2 + personal + effort / 4) * (level / 100) + 5) * charact * upplus;
      if (j == 'HP')
        $('#' + i + 'HPstrength').val(parseInt(hpResult));
      else
        $('#' + i + j + 'strength').val(parseInt(result));
      totaleffort += effort;
    });
    var hpeffort = parseInt($('#' + i + 'HPEffort').val()) / 252 * 46.5;
    var atkeffort = parseInt($('#' + i + 'ATKEffort').val()) / 252 * 41;
    var satkeffort = parseInt($('#' + i + 'SATKEffort').val()) / 252 * 41;
    var defeffort = parseInt($('#' + i + 'DEFEffort').val()) / 252 * 41;
    var sdefeffort = parseInt($('#' + i + 'SDEFEffort').val()) / 252 * 41;
    var speedeffort = parseInt($('#' + i + 'SPEEDEffort').val()) / 252 * 46.5;
    change6angle(i, hpeffort, atkeffort, satkeffort, defeffort, sdefeffort, speedeffort);
    $('#' + i + 'totaleffort').val(totaleffort);
  }
  $('#atkerselectNature').change(function () { calculateEach("atker"); });
  $('#deferselectNature').change(function () { calculateEach("defer") });

  var calculate = function () {
    var race = parseInt($('#race').val());
    var personal = parseInt($('#personal').val());
    var effort = parseInt($('#effort').val());
    var level = parseInt($('#level').val());
    var charact = natureVal;
    var res = (race * 2 + personal + effort / 4) * (level / 100) + level + 10;
    var upplus = parseFloat($('#upplus').val());
    var otherres = ((race * 2 + personal + effort / 4) * (level / 100) + 5) * charact * upplus;
    $('#Result').val(res.toString());
    $('#otherResult').val(otherres.toString());
    var atk = parseInt($('#atk').val());
    var def = parseInt($('#def').val());
    var power = parseInt($('#power').val());
    var selfplus = parseFloat($('#selfplus').val());
    var attrplus = parseFloat($('#attrplus').val());
    var weatherplus = parseFloat($('#weatherplus').val());
    var staffplus = parseFloat($('#staffplus').val());
    var characterplus = parseFloat($('#characterplus').val());
    var calculatedamage = ((2 * level + 10) / 250 * atk / def * power + 2) * selfplus * attrplus * weatherplus * staffplus * characterplus;
    $('#damage').val(Math.floor(calculatedamage * 0.85).toString() + "~" + Math.floor(calculatedamage).toString());
  }
  //改變值立刻計算結果
  $('#race,#personal,#effort,#level,#racerangeInput,#personalrangeInput,#effortrangeInput,#levelrangeInput,#atkrangeInput,#defrangeInput,#powerrangeInput,#atk,#def,#power').on('input', calculate);
  $('#upplus,#selfplus,#attrplus,#weatherplus,#staffplus,#characterplus').on('change', calculate);

  $('#atkerATKbutton,#atkerSATKbutton,#deferATKbutton,#deferSATKbutton').click(function () {
    let id = '#' + this.id.replace('button', 'strength');
    $('#atk').val($(id).val());
    calculate();
  });
  $('#deferDEFbutton,#deferSDEFbutton,#atkerDEFbutton,#atkerSDEFbutton').click(function () {
    let id = '#' + this.id.replace('button', 'strength');
    $('#def').val($(id).val());
    calculate();
  });
</script>

</html>