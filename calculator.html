<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<style>
  .Nature button {
    background-color: inherit;
    color: rgb(182, 182, 182);
    /* float: left; */
    border: none;
    outline: none;
    cursor: pointer;
    /* padding: 8px 15px; */
    transition: 0.3s;
  }

  .Nature button.active {
    background-color: rgb(70, 70, 70);
  }

  ._btn- {
    width: 20px;
    height: 20px;
    padding: 0;
    line-height: 0;
  }

  ._btn {
    width: 20px;
    height: 20px;
    padding: 0;
    line-height: 0;
  }

  .inputnumber {
    width: 30px;
  }

  th {
    font-size: 0.7em;
  }

  .SpeciesStrength {
    text-align: left;
    width: 40px;
  }

  #levelrangeInput {
    width: 70px;
  }

  input[type=text] {
    width: 30px;
    border: 0;
    margin-left: 0;
    background: transparent;
  }

  table th,
  td {
    border: 1px solid black;
  }

  table {
    table-layout: auto;
  }
</style>

<body>
  <div style="font-size: 0.7em;">
    <h6 style="margin: 0px 10px;">公式：</h6>
    <p style="margin: 0px 10px;">HP：(種*2+個體+努力/4)*Lv/100+Lv+10</p>
    <p style="margin: 0px 10px;">其他：[(種*2+個體+努力/4)*(Lv/100)+5]*性格</p>
    <p style="margin: 0px 10px;">傷害計算：[(2*Lv+10)/250*atk/def*威力+2]*加成</p>
  </div>
  <!-- 計算器table -->
  <table style="width: 100%;">
    <tr>
      <td>
        <h6 style="text-align: center;">攻擊方</h6>
        <select name="" id="atkerName"></select>
        <table id="atkerTable">
          <tr>
            <td></td>
            <td>HP<br><input type="text" readonly value="100" id="HPstrength"></td>
            <td></td>
          </tr>
          <tr>
            <td style="text-align: center;">ATK<br><input type="text" readonly value="100" id="ATKstrength"></td>
            <td rowspan="2">
              <div>
                <div class="hexagon1"></div>
                <div class="hexagon2"></div>
                <div class="hexagon3"></div>
              </div>
            </td>
            <td>SATK<br><input type="text" readonly value="100" id="SATKstrength"></td>
          </tr>
          <tr>
            <td>DEF<br><input type="text" readonly value="100" id="DEFstrength">
            </td>
            <td>SDEF<br><input type="text" readonly value="100" id="SDEFstrength"></td>
          </tr>
          <tr>
            <td></td>
            <td>SPEED<br><input type="text" readonly value="100" id="SPEEDstrength"></td>
            <td></td>
          </tr>
        </table>
        <table>
          <!-- 填入 -->
          <tr>
            <td style="padding: 0;"></td>
            <td style="padding: 0;">個體值</td>
            <td style="padding: 0;">努力值</td>
          </tr>
          <tr>
            <td>HP</td>
            <td>
              <select name="" id="" style="width: 50px;">
                <option value="31" selected>Best</option>
                <option value="30">Fantastic</option>
                <option value="VeryGood">Very Good</option>
                <option value="PrettyGood">Pretty Good</option>
                <option value="Decent">Decent</option>
                <option value="0">No good</option>
              </select>
            </td>
            <td>
              <input type="range" id="HPrangeInput" min="0" max="252" value="252" style="width: 80px;">
              <br>
              <input type="button" class="_btn-" value="-" id="effort-">
              <input type="text" class="inputnumber" value="252" id="effort">
              <input type="button" class="_btn" value="+" id="HPplus">
            </td>
          </tr>
        </table>
      </td>


      <td>
        <div id="defer">
          防守方
          <select name="" id="deferName"></select>
          <table class="deferTable"></table>
        </div>
      </td>
    </tr>
  </table>


  <table>

    <tr>
      <th>Level</th>
      <th>
        <input type="range" id="levelrangeInput" min="0" max="100" value="50">
        <input type="button" class="_btn-" value="-" id="level-">
        <input type="number" class="inputnumber" value="50" id="level" style="width: 50px;">
        <input type="button" class="_btn" value="+" id="levelplus">
      </th>
    </tr>
    <tr>
      <th>性格</th>
      <th class="Nature">
        <button onclick="switchNature1Tab('Nature1.1')" class="Nature1.1btn active" style="width: 40px;">1.1</button>
        <button onclick="switchNature1Tab('Nature1')" class="Nature1btn" style="width: 40px;">1</button>
        <button onclick="switchNature1Tab('Nature0.9')" class="Nature0.9btn" style="width: 40px;">0.9</button>
      </th>
    </tr>
    <tr>
      <th>能力提升</th>
      <th><select name="" id="upplus">
          <option value="0.5" selected>0.5</option>
          <option value="0.66" selected>0.66</option>
          <option value="1" selected>1</option>
          <option value="1.3">1.3</option>
          <option value="1.5">1.5</option>
          <option value="2">2</option>
          <option value="2.5">2.5</option>
          <option value="3">3</option>
          <option value="3.5">3.5</option>
          <option value="4">4</option>
        </select>
      </th>
    </tr>
    <tr>
      <th>其他結果</th>
      <th><input type="text" class="inputnumber" value="167.6125" id="otherResult"></th>
    </tr>
    <tr>
      <th>atk</th>
      <th><input type="range" id="atkrangeInput" min="0" max="1000" value="100">
        <input type="button" class="_btn-" value="-" id="atk-">
        <input type="number" class="inputnumber" value="100" id="atk">
        <input type="button" class="_btn" value="+" id="atkplus"></button>
      </th>
    </tr>
    <tr>
      <th>def</th>
      <th><input type="range" id="defrangeInput" min="0" max="1000" value="100">
        <input type="button" class="_btn-" value="-" id="def-">
        <input type="number" class="inputnumber" value="100" id="def">
        <input type="button" class="_btn" value="+" id="defplus"></button>
      </th>
    </tr>
    <tr>
      <th>威力</th>
      <th><input type="range" id="powerrangeInput" min="0" max="200" value="80">
        <input type="button" class="_btn-" value="-" id="power-">
        <input type="number" class="inputnumber" value="80" id="power">
        <input type="button" class="_btn" value="+" id="powerplus"></button>
      </th>
    </tr>
    <tr>
      <th>本系加成</th>
      <th><select name="" id="selfplus">
          <option value="1" selected>1</option>
          <option value="1.5">1.5</option>
          <option value="2">2</option>
        </select>
      </th>
    </tr>
    <tr>
      <th>屬性相剋</th>
      <th><select name="" id="attrplus">
          <option value="0.25">0.25</option>
          <option value="0.5">0.5</option>
          <option value="1" selected>1</option>
          <option value="2">2</option>
          <option value="4">4</option>
        </select></th>
    </tr>
    <tr>
      <th>天氣加成</th>
      <th><select name="" id="weatherplus">
          <option value="0.5">0.5</option>
          <option value="1" selected>1</option>
          <option value="1.5">1.5</option>
        </select></th>
    </tr>
    <tr>
      <th>道具</th>
      <th>
        <select name="" id="staffplus">
          <option value="1.5">講究系列</option>
          <option value="1" selected>無</option>
          <option value="1.3">生命寶珠</option>
          <option value="1.1">1.1</option>
          <option value="1.2">1.2</option>
        </select>
      </th>
    </tr>
    <tr>
      <th>特性</th>
      <th>
        <select name="" id="characterplus">
          <option value="1" selected>無</option>
          <option value="1.3">強行</option>
        </select>
      </th>
    </tr>
    <tr>
      <th>傷害計算</th>
      <th><input type="number" class="inputnumber" value="37.2" id="damage"></th>
    </tr>
  </table>
</body>
<script>
  //6角形
  var hexagon1length = 30;
  var sqrthexagon1length = (Math.sqrt(3) * hexagon1length).toFixed(1);
  $('.hexagon1').css("width", "0");
  $('.hexagon1').css("border-bottom", hexagon1length.toString() + "px solid rgb(185, 185, 185)");
  $('.hexagon1').css("border-left", sqrthexagon1length.toString() + "px solid transparent");
  $('.hexagon1').css("border-right", sqrthexagon1length.toString() + "px solid transparent");
  $('.hexagon2').css("width", (sqrthexagon1length * 2).toString() + "px");
  $('.hexagon2').css("height", (hexagon1length * 2).toString() + "px");
  $('.hexagon2').css("background-color", "rgb(185, 185, 185)");
  $('.hexagon3').css("width", "0");
  $('.hexagon3').css("border-top", hexagon1length.toString() + "px solid rgb(185, 185, 185)");
  $('.hexagon3').css("border-left", sqrthexagon1length.toString() + "px solid transparent");
  $('.hexagon3').css("border-right", sqrthexagon1length.toString() + "px solid transparent");
  var _6species = ["HP", "ATK", "DEF", "SATK", "SDEF", "SPEED"];
  _6species.forEach(element => {
    // var str = `
    // <tbody>
    // </tbody>`;
    // $('#atkerTable').append(str);
  });
  $(document).ready(function () {
    $('#atkerName').select2();
    $('#deferName').select2();
  });
  function switchcalculatorTab(id) {
    var allTable = ["atker", "defer"];
    for (var i in allTable) {
      for (var i in allTable) {
        if (allTable[i] != id) {
          document.getElementById(allTable[i]).style.display = 'none';
          document.getElementsByClassName(allTable[i] + "btn")[0].className = document.getElementsByClassName(allTable[i] + "btn")[0].className.replace(" active", "");
        }
        else {
          if (document.getElementsByClassName(allTable[i] + "btn")[0].className.includes(" active"))
            return;
          document.getElementById(allTable[i]).style.display = 'table-row';
          document.getElementsByClassName(allTable[i] + "btn")[0].className += " active";
        }
      }
    }
  }
  //tab switch
  var natureVal = 1.1;
  function switchNature1Tab(id) {
    var allTable = ["Nature1.1", "Nature1", "Nature0.9"];
    for (var i in allTable) {
      if (allTable[i] != id) {
        document.getElementsByClassName(allTable[i] + "btn")[0].className = document.getElementsByClassName(allTable[i] + "btn")[0].className.replace(" active", "");
      }
      else {
        if (document.getElementsByClassName(allTable[i] + "btn")[0].className.includes(" active"))
          return;
        document.getElementsByClassName(allTable[i] + "btn")[0].className += " active";
        natureVal = parseFloat(id.replace("Nature", ""));
        calculate();
      }
    }
  }
  //+- start
  $('#raceplus,#personalplus,#effortplus,#levelplus,#atkplus,#defplus,#powerplus').click(function () {
    var id = "#" + $(this).attr("id").replace('plus', '');
    var value = parseInt($(id).val()) + 1;
    $(id).val(value);
    $(id + "rangeInput").val(value);
    calculate();
  });
  $('#race-,#personal-,#effort-,#level-,#atk-,#def-,#power-').click(function () {
    var id = "#" + $(this).attr("id").replace('-', '');
    var value = parseInt($(id).val()) - 1;
    $(id).val(value);
    $(id + "rangeInput").val(value);
    calculate();
  });
  //+- end
  //拖拉同步改變text值
  $('#racerangeInput,#personalrangeInput,#effortrangeInput,#levelrangeInput,#atkrangeInput,#defrangeInput,#powerrangeInput').on('input', function () {
    var id = "#" + $(this).attr("id").replace('rangeInput', '');
    $(id).val($(this).val());
  });
  //text值同步改變拖拉長度
  $('#race,#personal,#effort,#level,#atk,#def,#power').on('input', function () {
    var rangeInputName = "#" + $(this).attr("id") + "rangeInput";
    $(rangeInputName).val($(this).val());
  });
  var calculate = function () {
    var race = parseInt($('#race').val());
    var personal = parseInt($('#personal').val());
    var effort = parseInt($('#effort').val());
    var level = parseInt($('#level').val());
    var charact = natureVal;
    var res = (race * 2 + personal + effort / 4) * (level / 100) + level + 10;
    var upplus = parseFloat($('#upplus').val());
    var otherres = ((race * 2 + personal + effort / 4) * (level / 100) + 5) * charact * upplus;
    $('#Result').val(res.toString());
    $('#otherResult').val(otherres.toString());
    var atk = parseInt($('#atk').val());
    var def = parseInt($('#def').val());
    var power = parseInt($('#power').val());
    var selfplus = parseFloat($('#selfplus').val());
    var attrplus = parseFloat($('#attrplus').val());
    var weatherplus = parseFloat($('#weatherplus').val());
    var staffplus = parseFloat($('#staffplus').val());
    var characterplus = parseFloat($('#characterplus').val());
    var calculatedamage = ((2 * level + 10) / 250 * atk / def * power + 2) * selfplus * attrplus * weatherplus * staffplus * characterplus;
    $('#damage').val(calculatedamage.toString());
  }
  //改變值立刻計算結果
  $('#race,#personal,#effort,#level,#racerangeInput,#personalrangeInput,#effortrangeInput,#levelrangeInput,#atkrangeInput,#defrangeInput,#powerrangeInput,#atk,#def,#power').on('input', calculate);
  $('#upplus,#selfplus,#attrplus,#weatherplus,#staffplus,#characterplus').on('change', calculate);
</script>

</html>